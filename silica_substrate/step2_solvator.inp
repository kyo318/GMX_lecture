* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.7 on Apr, 28. 2024. JOBID=1428764408
* SOLVATE PROTEIN IN WATER BOX
*

DIMENS CHSIZE 5000000 MAXRES 5000000 MAXGRP 5000000

! Read topology and parameter files
stream toppar.str

! Read PSF and Coordinates
open read unit 10 card name step1_nanomaterial.psf
read psf  unit 10 card

open read unit 10 card name step1_nanomaterial.crd
read coor unit 10 card

stream step1.1_user_input.str
stream step1_nanomaterial.str
calc A = 34.391
calc B = 34.0384
calc C = 41
set XTLtype = ORTHorhombic
if A eq @B set XTLtype = TETRagonal
if A eq @B if B eq @C set XTLtype = CUBIc
if impatch .ne. no then

   crystal define @XTLtype @A @B @C @{alpha} @{beta} @{gamma}

   open unit 10 read card name crystal_image.str
   crystal read unit 10 card
   open read unit 10 card name cubic.img
   read imag unit 10
   print images tran
   update imall
   open read card unit 10 name image.psf
   read image psf unit 10  
endif

define NM sele all end
!Reorient Solute (should be here)

open read unit 10 card name crystal_image.str
CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
CRYSTAL READ UNIT 10 CARD

!Image centering by residue
IMAGE BYATOM XCEN @xcen YCEN @ycen ZCEN @zcen

update imall
CRYSTAL FREE


dele atom sele NM end

!
! Write coordinates and information of solvated system
!

open write unit 10 card name step2_solvator.psf
write psf  unit 10 card

open write card unit 10 name step2_solvator.pdb
write coor pdb  unit 10

open write unit 10 card name step2_solvator.crd
write coor unit 10 card

open write unit 90 card name step2_solvator.str
write title unit 90
** assembly settings
**
* set boxtype = rect
* set XTLtype  = @XTLtype
* set A = @A
* set B = @B
* set C = @C
* set Alpha = @Alpha
* set Beta  = @Beta
* set Gamma = @Gamma
* set xcen = @xcen
* set ycen = @ycen
* set zcen = @zcen

stop
